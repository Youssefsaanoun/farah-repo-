import{a as N}from"./chunk-HDE3HEQ7.js";import{a as D}from"./chunk-LQIH6OPP.js";import{a as F,c as A,f as U,h as B,s as W}from"./chunk-24YXKLC5.js";import{$a as O,Ea as b,Gb as V,Hb as Q,Ka as d,La as o,Lb as j,Ma as i,Mb as L,Na as p,S as g,Sa as _,T as f,Ta as m,Ua as u,bb as s,cb as h,d as k,db as w,gb as E,hb as I,ib as q,ma as v,mb as x,nb as z,oa as a,pb as T,v as y,va as S,x as P,za as M}from"./chunk-MVKOQPDJ.js";import"./chunk-FDERIQAA.js";function $(r,e){r&1&&(o(0,"div",9),p(1,"i",10),i())}function H(r,e){if(r&1){let t=_();o(0,"button",11),m("click",function(){g(t);let c=u();return f(c.clearSearch())}),p(1,"i",12),i()}}function J(r,e){if(r&1){let t=_();o(0,"tr")(1,"td"),p(2,"img",16),x(3,"imageUrl"),i(),o(4,"td")(5,"strong"),s(6),i()(),o(7,"td"),s(8),i(),o(9,"td")(10,"div",17)(11,"button",18),m("click",function(){let c=g(t).$implicit,l=u(2);return f(l.updateStock(c,c.variants[0].stockQuantity-1))}),p(12,"i",19),i(),p(13,"input",20),o(14,"button",21),m("click",function(){let c=g(t).$implicit,l=u(2);return f(l.updateStock(c,c.variants[0].stockQuantity+1))}),p(15,"i",22),i()()(),o(16,"td")(17,"span",23),s(18),i()()()}if(r&2){let t=e.$implicit,n=u(2);a(2),d("src",z(3,10,t.images==null||t.images[0]==null?null:t.images[0].imageUrl)||"assets/placeholder.jpg",v),a(4),h(t.name),a(2),h((t.category==null?null:t.category.name)||"N/A"),a(3),d("disabled",t.variants[0].stockQuantity<=0),a(2),d("ngModel",t.variants[0].stockQuantity),a(4),O("in-stock",n.getStock(t)>0)("out-of-stock",n.getStock(t)===0),a(),w(" ",n.getStock(t)>0?"En Stock":"Rupture de Stock"," ")}}function K(r,e){if(r&1&&(o(0,"div",13)(1,"table",14)(2,"thead")(3,"tr")(4,"th"),s(5,"Image"),i(),o(6,"th"),s(7,"Nom du Produit"),i(),o(8,"th"),s(9,"Cat\xE9gorie"),i(),o(10,"th"),s(11,"Quantit\xE9 Totale"),i(),o(12,"th"),s(13,"Statut"),i()()(),o(14,"tbody"),b(15,J,19,12,"tr",15),x(16,"slice"),i()()()),r&2){let t=u();a(15),d("ngForOf",T(16,1,t.products,0,t.visibleLimit))}}function X(r,e){if(r&1){let t=_();o(0,"button",27),m("click",function(){g(t);let c=u(2);return f(c.showAllProducts())}),s(1," Voir plus de produits "),p(2,"i",28),i()}}function Z(r,e){if(r&1){let t=_();o(0,"button",29),m("click",function(){g(t);let c=u(2);return f(c.showLessProducts())}),s(1," Voir moins "),p(2,"i",30),i()}}function tt(r,e){if(r&1&&(o(0,"div",24),b(1,X,3,0,"button",25)(2,Z,3,0,"button",26),i()),r&2){let t=u();a(),d("ngIf",t.visibleLimit<t.products.length),a(),d("ngIf",t.visibleLimit>=t.products.length)}}var Y=class r{constructor(e){this.productService=e}products=[];loading=!0;searchQuery=null;searchSubject=new k;searchSubscription;allProducts=[];ngOnInit(){this.productService.getAllProducts().subscribe({next:e=>{this.processProducts(e),this.allProducts=[...this.products],this.loading=!1},error:e=>{console.error("Failed to load products",e),this.loading=!1}}),this.searchSubscription=this.searchSubject.pipe(y(300),P()).subscribe(e=>{this.filterProducts(e)})}filterProducts(e){if(!e||e.trim()===""){this.products=[...this.allProducts];return}let t=e.toLowerCase();this.products=this.allProducts.filter(n=>{let c=(n.name||"").toLowerCase().includes(t),l=(n.category?.name||"").toLowerCase().includes(t),C=this.getStock(n),R=C.toString().includes(t),G=(C>0?"in stock":"out of stock").includes(t);return c||l||R||G})}ngOnDestroy(){this.searchSubscription&&this.searchSubscription.unsubscribe()}onSearchInput(e){this.searchSubject.next(e)}clearSearch(){this.searchQuery="",this.searchSubject.next("")}visibleLimit=7;showAllProducts(){this.visibleLimit=this.products.length}showLessProducts(){this.visibleLimit=7,window.scrollTo({top:0,behavior:"smooth"})}processProducts(e){this.products=e.map(t=>((!t.variants||t.variants.length===0)&&(t.variants=[{id:0,size:"Standard",color:"Default",stockQuantity:0}]),t))}getStock(e){return e.variants[0].stockQuantity}updateStock(e,t){t<0||(e.variants[0].stockQuantity=t,this.saveStock(e))}saveStock(e){let t=e.variants[0],n={name:e.name,description:e.description,price:e.price,category:e.category,variants:[{size:"Standard",color:"Default",stockQuantity:t.stockQuantity}]};t.id>0&&(n.variants[0].id=t.id),this.productService.updateProduct(e.id,n).subscribe({next:()=>{console.log("Stock auto-saved")},error:c=>{console.error("Failed to update stock",c)}})}static \u0275fac=function(t){return new(t||r)(S(N))};static \u0275cmp=M({type:r,selectors:[["app-stock"]],decls:11,vars:5,consts:[[1,"container","fade-in"],["class","text-center",4,"ngIf"],[1,"search-section"],[1,"search-bar"],[1,"fas","fa-search","search-icon"],["type","text","placeholder","Rechercher produits, cat\xE9gorie, statut...",3,"ngModelChange","ngModel"],["class","clear-btn","title","Effacer la recherche",3,"click",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","view-more-container","style","text-align: center; margin-top: 1.5rem; display: flex; justify-content: center; gap: 1rem; padding-bottom: 2rem;",4,"ngIf"],[1,"text-center"],[1,"fas","fa-spinner","fa-spin","fa-2x"],["title","Effacer la recherche",1,"clear-btn",3,"click"],[1,"fas","fa-times"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],["alt","Produit",1,"product-thumb",3,"src"],[1,"quantity-controls"],[1,"qty-btn",3,"click","disabled"],[1,"fas","fa-minus"],["type","number","readonly","",1,"qty-input",3,"ngModel"],[1,"qty-btn",3,"click"],[1,"fas","fa-plus"],[1,"badge"],[1,"view-more-container",2,"text-align","center","margin-top","1.5rem","display","flex","justify-content","center","gap","1rem","padding-bottom","2rem"],["class","btn-primary","style","padding: 0.8rem 1.5rem; font-size: 1rem; border-radius: 50px;",3,"click",4,"ngIf"],["class","btn-secondary","style","padding: 0.8rem 1.5rem; font-size: 1rem; border-radius: 50px; background-color: #f8f9fa; color: #333; border: 1px solid #ddd;",3,"click",4,"ngIf"],[1,"btn-primary",2,"padding","0.8rem 1.5rem","font-size","1rem","border-radius","50px",3,"click"],[1,"fas","fa-arrow-down",2,"margin-left","0.5rem"],[1,"btn-secondary",2,"padding","0.8rem 1.5rem","font-size","1rem","border-radius","50px","background-color","#f8f9fa","color","#333","border","1px solid #ddd",3,"click"],[1,"fas","fa-arrow-up",2,"margin-left","0.5rem"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"h2"),s(2,"Gestion de Stock"),i(),b(3,$,2,0,"div",1),o(4,"div",2)(5,"div",3),p(6,"i",4),o(7,"input",5),q("ngModelChange",function(l){return I(n.searchQuery,l)||(n.searchQuery=l),l}),m("ngModelChange",function(l){return n.onSearchInput(l)}),i(),b(8,H,2,0,"button",6),i()(),b(9,K,17,5,"div",7)(10,tt,3,2,"div",8),i()),t&2&&(a(3),d("ngIf",n.loading),a(4),E("ngModel",n.searchQuery),a(),d("ngIf",n.searchQuery),a(),d("ngIf",!n.loading),a(),d("ngIf",n.products.length>7))},dependencies:[L,V,Q,W,F,B,A,U,j,D],styles:[".container[_ngcontent-%COMP%]{padding:2rem;padding-top:100px}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff;border-radius:8px;box-shadow:0 4px 15px #0000000d}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #eee}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:600}.search-section[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:2rem 0 3rem;padding:0 1rem}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;background:#fff;border-radius:50px;padding:.75rem 1.5rem;width:100%;max-width:600px;box-shadow:0 5px 20px #0000000d;border:1px solid rgba(0,0,0,.05);transition:all .4s cubic-bezier(.16,1,.3,1)}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]:hover{box-shadow:0 8px 25px #00000014;transform:translateY(-1px)}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]:focus-within{box-shadow:0 10px 40px #d4af3726;border-color:#d4af374d;transform:translateY(-2px)}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{color:#b0b0b0;font-size:1.1rem;margin-right:1rem;transition:color .3s}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;flex:1;font-size:1rem;color:#333;font-weight:500;background:transparent}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#aaa;font-weight:400;transition:opacity .3s}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]:focus-within   .search-icon[_ngcontent-%COMP%]{color:#d4af37}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]{background:#f0f0f0;border:none;cursor:pointer;color:#666;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-left:.5rem;transition:all .2s ease;font-size:.8rem}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]:hover{background:#e0e0e0;color:#333;transform:scale(1.1)}.product-thumb[_ngcontent-%COMP%]{width:45px;height:55px;object-fit:cover;border-radius:4px}.stock-qty[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem}.stock-qty.low-stock[_ngcontent-%COMP%]{color:#ff9800}.badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:4px;font-size:.85rem}.badge.in-stock[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.badge.out-of-stock[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.quantity-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:0;background:#f8f9fa;border-radius:50px;padding:3px;border:1px solid #e9ecef;width:fit-content;margin-bottom:.5rem}.quantity-controls[_ngcontent-%COMP%]   .qty-btn[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#fff;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#555;font-size:.8rem;transition:all .2s ease;box-shadow:0 2px 5px #0000000d}.quantity-controls[_ngcontent-%COMP%]   .qty-btn[_ngcontent-%COMP%]:hover:not([disabled]){background:#2d3748;color:#fff;transform:scale(1.05)}.quantity-controls[_ngcontent-%COMP%]   .qty-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background:#f1f3f5}.quantity-controls[_ngcontent-%COMP%]   .qty-input[_ngcontent-%COMP%]{width:50px;text-align:center;border:none;background:transparent;font-weight:600;font-size:.95rem;color:#2d3748;padding:0;margin:0 5px}.quantity-controls[_ngcontent-%COMP%]   .qty-input[_ngcontent-%COMP%]::-webkit-inner-spin-button, .quantity-controls[_ngcontent-%COMP%]   .qty-input[_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.btn-save-mini[_ngcontent-%COMP%]{background:#2d3748;color:#fff;border:none;padding:.3rem .8rem;border-radius:4px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:.4rem;font-size:.85rem;transition:all .2s}.btn-save-mini[_ngcontent-%COMP%]:hover{background:#1a202c;transform:translateY(-1px)}.btn-save-mini[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.85rem}.btn-save-mini[_ngcontent-%COMP%]{background:#007bff;color:#fff;border:none;width:32px;height:32px;border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}.btn-save-mini[_ngcontent-%COMP%]:hover{background:#0056b3}.btn-save-mini[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.9rem}"]})};export{Y as StockComponent};
