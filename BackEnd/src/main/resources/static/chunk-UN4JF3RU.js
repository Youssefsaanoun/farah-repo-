import{a as p}from"./chunk-3MRXNU4J.js";import{I as n,M as o,Qb as m,Rb as c,Vb as f,e as a,ja as v}from"./chunk-MVKOQPDJ.js";var h=class s{constructor(r,t,e){this.http=r;this.authService=t;this.platformId=e;m(this.platformId)&&this.authService.currentUser$.subscribe(i=>{i?this.loadFavorites(i.id):this.favoriteItems.next([])})}favoriteItems=new a([]);favoriteItems$=this.favoriteItems.asObservable();apiUrl=`${f.apiUrl}/favorites`;loadFavorites(r){this.http.get(`${this.apiUrl}/${r}`).subscribe({next:t=>{let e=t.map(i=>i.product);this.favoriteItems.next(e)},error:t=>console.error("Error loading favorites",t)})}isFavorite(r){return this.favoriteItems.value.some(t=>t.id===r)}addFavorite(r){let t=this.authService.getCurrentUser();if(!t){alert("Please login to add to favorites");return}this.isFavorite(r.id)||this.http.post(`${this.apiUrl}/${t.id}/${r.id}`,{}).subscribe({next:()=>{let e=this.favoriteItems.value;this.favoriteItems.next([...e,r])},error:e=>console.error("Error adding to favorites",e)})}removeFavorite(r){let t=this.authService.getCurrentUser();t&&this.http.delete(`${this.apiUrl}/${t.id}/${r}`).subscribe({next:()=>{let e=this.favoriteItems.value;this.favoriteItems.next(e.filter(i=>i.id!==r))},error:e=>console.error("Error removing from favorites",e)})}static \u0275fac=function(t){return new(t||s)(o(c),o(p),o(v))};static \u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})};export{h as a};
