import{a as f}from"./chunk-FZA2A4RH.js";import{I as n,M as o,Qb as c,Rb as m,e as a,ja as v}from"./chunk-OXYRPRF3.js";var h=class s{constructor(e,t,r){this.http=e;this.authService=t;this.platformId=r;c(this.platformId)&&this.authService.currentUser$.subscribe(i=>{i?this.loadFavorites(i.id):this.favoriteItems.next([])})}favoriteItems=new a([]);favoriteItems$=this.favoriteItems.asObservable();apiUrl="http://localhost:8081/api/favorites";loadFavorites(e){this.http.get(`${this.apiUrl}/${e}`).subscribe({next:t=>{let r=t.map(i=>i.product);this.favoriteItems.next(r)},error:t=>console.error("Error loading favorites",t)})}isFavorite(e){return this.favoriteItems.value.some(t=>t.id===e)}addFavorite(e){let t=this.authService.getCurrentUser();if(!t){alert("Please login to add to favorites");return}this.isFavorite(e.id)||this.http.post(`${this.apiUrl}/${t.id}/${e.id}`,{}).subscribe({next:()=>{let r=this.favoriteItems.value;this.favoriteItems.next([...r,e])},error:r=>console.error("Error adding to favorites",r)})}removeFavorite(e){let t=this.authService.getCurrentUser();t&&this.http.delete(`${this.apiUrl}/${t.id}/${e}`).subscribe({next:()=>{let r=this.favoriteItems.value;this.favoriteItems.next(r.filter(i=>i.id!==e))},error:r=>console.error("Error removing from favorites",r)})}static \u0275fac=function(t){return new(t||s)(o(m),o(f),o(v))};static \u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})};export{h as a};
